IDENTIFICATION DIVISION.
PROGRAM-ID. INSERTION-SORT.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  ARR-SIZE     PIC 9(2) VALUE 5.
01  ARR          PIC 9(3) OCCURS 5 TIMES.
01  I            PIC 9(2).
01  J            PIC 9(2).
01  KEY          PIC 9(3).

PROCEDURE DIVISION.
    MOVE 034 TO ARR(1).
    MOVE 012 TO ARR(2).
    MOVE 045 TO ARR(3).
    MOVE 023 TO ARR(4).
    MOVE 009 TO ARR(5).

    PERFORM VARYING I FROM 2 BY 1 UNTIL I > ARR-SIZE
        MOVE ARR(I) TO KEY
        MOVE I TO J
        PERFORM UNTIL J <= 1 OR ARR(J - 1) <= KEY
            MOVE ARR(J - 1) TO ARR(J)
            SUBTRACT 1 FROM J
        END-PERFORM
        MOVE KEY TO ARR(J)
    END-PERFORM.

    DISPLAY "ARRAY ORDENADO:".
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > ARR-SIZE
        DISPLAY ARR(I)
    END-PERFORM.

    STOP RUN.
